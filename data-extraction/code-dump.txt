

function modifySheet() {
  var sheetName = '00. CSV IMPORT';
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName(sheetName);

  // Step 1: Remove rows where column L is blank
  removeRowsWithBlankColumnL(sheet);

  // Step 2: Update column M as per the requirement
  updateColumnM(sheet);

  // Step 3: Move values from Column X to Column I (only for rows where X has data)
  moveXtoI(sheet);

  // Step 4: Fill '0' in blank cells from A2 to W till the last updated row
  fillZeros(sheet);

  // Step 5: Highlight cells in column I that are not equal to column J
  highlightMismatchedData(sheet);
}

function removeRowsWithBlankColumnL(sheet) {
  var data = sheet.getDataRange().getValues();
  for (var i = data.length - 1; i >= 0; i--) {
    if (data[i][11] === '') { // Column L (0-indexed 11)
      sheet.deleteRow(i + 1);
    }
  }
}

function updateColumnM(sheet) {
  var lastRow = sheet.getLastRow();
  var columnMIndex = 12; // Column M is at index 12 (0-indexed)

  for (var i = 1; i <= lastRow; i++) {
    var cellValue = String(sheet.getRange(i, columnMIndex + 1).getValue()); // Convert to string
    if (cellValue && cellValue.indexOf('\n') !== -1) {
      var updatedValue = cellValue.replace(/\n/g, '. ');
      sheet.getRange(i, columnMIndex + 1).setValue(updatedValue);
    }
  }
}

// NEW: Move Column X → Column I only for rows where X has data
function moveXtoI(sheet) {
  var lastRow = sheet.getLastRow();
  if (lastRow < 2) return;

  var colI = 9;   // Column I
  var colX = 24;  // Column X

  // Read all values from Column X starting row 2
  var xValues = sheet.getRange(2, colX, lastRow - 1, 1).getValues();

  for (var i = 0; i < xValues.length; i++) {
    var val = xValues[i][0];

    // Only process rows where X has data
    if (val !== "" && val !== null) {
      var row = i + 2;

      // Write value to Column I
      sheet.getRange(row, colI).setValue(val);

      // Clear the original value in Column X
      sheet.getRange(row, colX).setValue("");
    }
  }
}

function fillZeros(sheet) {
  var lastRow = sheet.getLastRow();
  var lastColumn = sheet.getLastColumn();
  var range = sheet.getRange(2, 1, lastRow - 1, lastColumn);

  // Unmerge cells in the range
  sheet.getRange(range.getRow(), range.getColumn(), range.getNumRows(), range.getNumColumns()).breakApart();

  var data = range.getValues();
  for (var i = 0; i < data.length; i++) {
    for (var j = 0; j < data[i].length; j++) {
      if (data[i][j] === null || data[i][j] === undefined || data[i][j] === '') {
        range.getCell(i + 1, j + 1).setValue(0);
      }
    }
  }
}

function highlightMismatchedData(sheet) {
  var lastRow = sheet.getLastRow();
  var rangeToCheck = sheet.getRange(2, 9, lastRow - 1, 2); // Columns I and J

  var dataToCheck = rangeToCheck.getValues();
  var backgrounds = [];

  for (var i = 0; i < dataToCheck.length; i++) {
    if (dataToCheck[i][0] !== dataToCheck[i][1]) {
      backgrounds.push(['red', 'red']);
    } else {
      backgrounds.push(['', '']);
    }
  }

  rangeToCheck.setBackgrounds(backgrounds);
}

 
 
 	
function modifySheet() {
  var sheetName = '00. CSV IMPORT';
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName(sheetName);

  // Step 1: Remove rows where column L is blank
  removeRowsWithBlankColumnL(sheet);

  // Step 2: Update column M as per the requirement
  updateColumnM(sheet);

  // Step 3: Move values from Column X to Column I (only for rows where X has data)
  moveXtoI(sheet);

  // Step 4: Fill '0' in blank cells from A2 to W till the last updated row
  fillZeros(sheet);

  // Step 5: Highlight cells in column I that are not equal to column J
  highlightMismatchedData(sheet);
}

function removeRowsWithBlankColumnL(sheet) {
  var data = sheet.getDataRange().getValues();
  for (var i = data.length - 1; i >= 0; i--) {
    if (data[i][11] === '') { // Column L (0-indexed 11)
      sheet.deleteRow(i + 1);
    }
  }
}

function updateColumnM(sheet) {
  var lastRow = sheet.getLastRow();
  var columnMIndex = 12; // Column M is at index 12 (0-indexed)

  for (var i = 1; i <= lastRow; i++) {
    var cellValue = String(sheet.getRange(i, columnMIndex + 1).getValue()); // Convert to string
    if (cellValue && cellValue.indexOf('\n') !== -1) {
      var updatedValue = cellValue.replace(/\n/g, '. ');
      sheet.getRange(i, columnMIndex + 1).setValue(updatedValue);
    }
  }
}

// NEW: Move Column X → Column I only for rows where X has data
function moveXtoI(sheet) {
  var lastRow = sheet.getLastRow();
  if (lastRow < 2) return;

  var colI = 9;   // Column I
  var colX = 24;  // Column X

  // Read all values from Column X starting row 2
  var xValues = sheet.getRange(2, colX, lastRow - 1, 1).getValues();

  for (var i = 0; i < xValues.length; i++) {
    var val = xValues[i][0];

    // Only process rows where X has data
    if (val !== "" && val !== null) {
      var row = i + 2;

      // Write value to Column I
      sheet.getRange(row, colI).setValue(val);

      // Clear the original value in Column X
      sheet.getRange(row, colX).setValue("");
    }
  }
}

function fillZeros(sheet) {
  var lastRow = sheet.getLastRow();
  var lastColumn = sheet.getLastColumn();
  var range = sheet.getRange(2, 1, lastRow - 1, lastColumn);

  // Unmerge cells in the range
  sheet.getRange(range.getRow(), range.getColumn(), range.getNumRows(), range.getNumColumns()).breakApart();

  var data = range.getValues();
  for (var i = 0; i < data.length; i++) {
    for (var j = 0; j < data[i].length; j++) {
      if (data[i][j] === null || data[i][j] === undefined || data[i][j] === '') {
        range.getCell(i + 1, j + 1).setValue(0);
      }
    }
  }
}

function highlightMismatchedData(sheet) {
  var lastRow = sheet.getLastRow();
  var rangeToCheck = sheet.getRange(2, 9, lastRow - 1, 2); // Columns I and J

  var dataToCheck = rangeToCheck.getValues();
  var backgrounds = [];

  for (var i = 0; i < dataToCheck.length; i++) {
    if (dataToCheck[i][0] !== dataToCheck[i][1]) {
      backgrounds.push(['red', 'red']);
    } else {
      backgrounds.push(['', '']);
    }
  }

  rangeToCheck.setBackgrounds(backgrounds);
}

Turn on screen reader support
To enable screen reader support, press ⌘+Option+Z To learn about keyboard shortcuts, press ⌘slash




Get professional email like "@your-company.com"
Plus 2 TB of storage per user, longer video calls, and more with Google Workspace.
SCRIPTS DETAILED
100%
D4

// MainScript.gs

function runAllScriptsInExport() {
  // Call function1
  clearSSheetData();

  // Call function2
  copyDataToExportOrders();

  // Call function3
  convertTimeRangesAndAddWTD();

  // Call function4
  updateOrders_TS01_to_TS16();

 // Call function5
  swapDates();
}
 
 
 	
// MainScript.gs

function runAllScriptsInExport() {
  // Call function1
  clearSSheetData();

  // Call function2
  copyDataToExportOrders();

  // Call function3
  convertTimeRangesAndAddWTD();

  // Call function4
  updateOrders_TS01_to_TS16();

 // Call function5
  swapDates();
}
Turn on screen reader support
To enable screen reader support, press ⌘+Option+Z To learn about keyboard shortcuts, press ⌘slash




Get professional email like "@your-company.com"
Plus 2 TB of storage per user, longer video calls, and more with Google Workspace.
SCRIPTS DETAILED
100%
F5

function clearSSheetData() {
  var sheetName = '1. EXPORT ORDERS';
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var sheet = ss.getSheetByName(sheetName);
  
  if (sheet) {
    var lastRow = sheet.getLastRow();
    
    // Clear data in columns A to Z from row 2 to the last row
    sheet.getRange('A2:Z' + lastRow).clearContent();
  
  } else {
    Logger.log("Sheet not found.");
  }
}

 
 
 	
function clearSSheetData() {
  var sheetName = '1. EXPORT ORDERS';
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var sheet = ss.getSheetByName(sheetName);
  
  if (sheet) {
    var lastRow = sheet.getLastRow();
    
    // Clear data in columns A to Z from row 2 to the last row
    sheet.getRange('A2:Z' + lastRow).clearContent();
  
  } else {
    Logger.log("Sheet not found.");
  }
}

Turn on screen reader support
To enable screen reader support, press ⌘+Option+Z To learn about keyboard shortcuts, press ⌘slash




Get professional email like "@your-company.com"
Plus 2 TB of storage per user, longer video calls, and more with Google Workspace.
SCRIPTS DETAILED
100%
F6

function copyDataToExportOrders() {
  // Get source and destination sheets
  var sourceSheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName('00. CSV IMPORT');
  var destinationSheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName('1. EXPORT ORDERS');
  
  // Get the data range in the source sheet starting from row 2
  var sourceDataRange = sourceSheet.getRange(2, 1, sourceSheet.getLastRow()-1, sourceSheet.getLastColumn());
  
  // Get the values from the source data range
  var sourceDataValues = sourceDataRange.getValues();
  
  // Get the destination range in the destination sheet starting from row 2
  var destinationRange = destinationSheet.getRange(2, 1, sourceDataValues.length, 26); // Adjust the number 15 based on your requirement
  
  // Clear existing data in the destination range
  destinationRange.clearContent();
  
  // Set the values in the destination range based on your specifications
destinationRange.setValues(sourceDataValues.map(row => [
    row[0],  // Column A
    row[1],  // Column B
    row[2],  // Column C
    row[4],  // Column D
    row[5],  // Column E
    row[6],  // Column F
    row[7],  // Column G
    row[8],  // Column H
    row[10],  // Column I
    row[11],  // Column J
    "",      // Blank column K
    "",      // Blank column L
    "",      // Blank column M
    "",      // Blank column N
    "",      // Blank column O
    "",      // Column P
    "",      // Column Q
    "",     // Column R
    row[12], // Column S
    row[13], // Column T
    "",      // Column U
    row[20], // Column V
    row[21], // Column W
    "",      // Blank column X
    "",      // Blank column Y
    row[22], // Column Z
    // Leave other columns blank
  ]));

}

 
 
 	
function copyDataToExportOrders() {
  // Get source and destination sheets
  var sourceSheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName('00. CSV IMPORT');
  var destinationSheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName('1. EXPORT ORDERS');
  
  // Get the data range in the source sheet starting from row 2
  var sourceDataRange = sourceSheet.getRange(2, 1, sourceSheet.getLastRow()-1, sourceSheet.getLastColumn());
  
  // Get the values from the source data range
  var sourceDataValues = sourceDataRange.getValues();
  
  // Get the destination range in the destination sheet starting from row 2
  var destinationRange = destinationSheet.getRange(2, 1, sourceDataValues.length, 26); // Adjust the number 15 based on your requirement
  
  // Clear existing data in the destination range
  destinationRange.clearContent();
  
  // Set the values in the destination range based on your specifications
destinationRange.setValues(sourceDataValues.map(row => [
    row[0],  // Column A
    row[1],  // Column B
    row[2],  // Column C
    row[4],  // Column D
    row[5],  // Column E
    row[6],  // Column F
    row[7],  // Column G
    row[8],  // Column H
    row[10],  // Column I
    row[11],  // Column J
    "",      // Blank column K
    "",      // Blank column L
    "",      // Blank column M
    "",      // Blank column N
    "",      // Blank column O
    "",      // Column P
    "",      // Column Q
    "",     // Column R
    row[12], // Column S
    row[13], // Column T
    "",      // Column U
    row[20], // Column V
    row[21], // Column W
    "",      // Blank column X
    "",      // Blank column Y
    row[22], // Column Z
    // Leave other columns blank
  ]));

}

Turn on screen reader support
To enable screen reader support, press ⌘+Option+Z To learn about keyboard shortcuts, press ⌘slash




Get professional email like "@your-company.com"
Plus 2 TB of storage per user, longer video calls, and more with Google Workspace.
SCRIPTS DETAILED
100%
F7

function convertTimeRangesAndAddWTD() {
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName('1. EXPORT ORDERS');
  var dataRange = sheet.getDataRange();
  var values = dataRange.getValues();

  for (var i = 0; i < values.length; i++) {
    var cellValueV = values[i][21]; // Column V is index 21 (0-based)
    var cellValueA = values[i][0];  // Column A is index 0 (0-based)
    var cellValueJ = values[i][9];  // Column J is index 9 (0-based)

    // Convert time range strings to labels
    if (cellValueV === 'Dinner (1.30 PM - 7.30 PM)') {
      values[i][21] = 'DINNER';
    } else if (cellValueV === 'Lunch (9.00 AM - 2.00 PM)') {
      values[i][21] = 'LUNCH';
    } else if (cellValueV === 'Lunch (9.00 AM - 3.00 PM)') {
      values[i][21] = 'LUNCH';
    } else if (cellValueV === 'Lunch (9.30 AM - 2.30 PM)') {
      values[i][21] = 'LUNCH';
    } else if (cellValueV === 'Lunch (4.00 AM - 8.00 AM)') {
      values[i][21] = 'LUNCH';
    } else if (cellValueV === 'Lunch (10.30 AM - 2.00 PM)') {
      values[i][21] = 'LUNCH';
    } else if (cellValueV === 'Lunch (6.00 AM - 1.00 PM)') {
      values[i][21] = 'LUNCH';
    } else if (cellValueV === 'Lunch (6.00 AM - 2.00 PM)') {
      values[i][21] = 'LUNCH';
    } else if (cellValueV === 'Lunch (6.00 AM - 11.00 AM)') {
      values[i][21] = 'LUNCH';
    } else if (cellValueV === 'Lunch (7.00 AM - 1.00 PM)') {
      values[i][21] = 'LUNCH';
    } else if (cellValueV === 'Dinner (2.00 PM - 8.00 PM)') {
      values[i][21] = 'DINNER';
    } else if (cellValueV === 'Dinner (6.00 PM - 9.00 PM)') {
      values[i][21] = 'DINNER';
    } else if (cellValueV === 'Lunch (4.00 AM - 11.00 AM)') {
      values[i][21] = 'LUNCH';
    } else if (cellValueV === 'Lunch (8.00 AM - 11.00 AM)') {
      values[i][21] = 'LUNCH';
    } else if (cellValueV === 'Lunch (9.00 AM - 1.00 PM)') {
      values[i][21] = 'LUNCH';
    } else if (cellValueV === 'Lunch (10.00 AM - 3.00 PM)') {
      values[i][21] = 'LUNCH';
    }

    // Check if the SKU in column J matches the specified SKUs
    var skusToMatchWTD = [
      'STASH-TD-TS01-W05-ONCA-VEG08',
      'STASH-TD-TS02-W05-ONCA-VEG08',
      'STASH-TD-TS03-W05-ONCA-VEG12',
      'STASH-TD-TS04-W05-ONCA-VEG12',
      'STASH-TD-TS05-W05-ONCA-VEG12',
      'STASH-TD-TS06-W05-ONCA-NVG12',
      'STASH-TD-TS07-W05-ONCA-NVG12',
      'STASH-TD-TS08-W05-ONCA-NVG12',
      'STASH-TD-TS10-W05-ONCA-VEG08',
      'STASH-TD-TS11-W05-ONCA-VEG08',
      'STASH-TD-TS12-W05-ONCA-VEG08',
      'STASH-TD-TS13-W05-ONCA-VEG08',
      'STASH-TD-TS14-W05-ONCA-VEG12',
      'STASH-TD-TS15-W05-ONCA-VEG12',
      'STASH-TD-TS16-W05-ONCA-VEG12'

    ];
    
    var skusToMatchGTD = [
      'STASH-TD-TS09-W05-ONCA-GUJ01'
    ];

    // Add '-WTD' to the Order ID in column A if the SKU matches the specified SKUs for WTD
    if (skusToMatchWTD.indexOf(cellValueJ) !== -1) {
      values[i][0] += '-WTD';
    }

    // Add '-GTD' to the Order ID in column A if the SKU matches the specified SKU for GTD
    if (skusToMatchGTD.indexOf(cellValueJ) !== -1) {
      values[i][0] += '-GTD';
    }
  }

  // Update the values in the sheet
  dataRange.setValues(values);
}

 
 
 	
function convertTimeRangesAndAddWTD() {
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName('1. EXPORT ORDERS');
  var dataRange = sheet.getDataRange();
  var values = dataRange.getValues();

  for (var i = 0; i < values.length; i++) {
    var cellValueV = values[i][21]; // Column V is index 21 (0-based)
    var cellValueA = values[i][0];  // Column A is index 0 (0-based)
    var cellValueJ = values[i][9];  // Column J is index 9 (0-based)

    // Convert time range strings to labels
    if (cellValueV === 'Dinner (1.30 PM - 7.30 PM)') {
      values[i][21] = 'DINNER';
    } else if (cellValueV === 'Lunch (9.00 AM - 2.00 PM)') {
      values[i][21] = 'LUNCH';
    } else if (cellValueV === 'Lunch (9.00 AM - 3.00 PM)') {
      values[i][21] = 'LUNCH';
    } else if (cellValueV === 'Lunch (9.30 AM - 2.30 PM)') {
      values[i][21] = 'LUNCH';
    } else if (cellValueV === 'Lunch (4.00 AM - 8.00 AM)') {
      values[i][21] = 'LUNCH';
    } else if (cellValueV === 'Lunch (10.30 AM - 2.00 PM)') {
      values[i][21] = 'LUNCH';
    } else if (cellValueV === 'Lunch (6.00 AM - 1.00 PM)') {
      values[i][21] = 'LUNCH';
    } else if (cellValueV === 'Lunch (6.00 AM - 2.00 PM)') {
      values[i][21] = 'LUNCH';
    } else if (cellValueV === 'Lunch (6.00 AM - 11.00 AM)') {
      values[i][21] = 'LUNCH';
    } else if (cellValueV === 'Lunch (7.00 AM - 1.00 PM)') {
      values[i][21] = 'LUNCH';
    } else if (cellValueV === 'Dinner (2.00 PM - 8.00 PM)') {
      values[i][21] = 'DINNER';
    } else if (cellValueV === 'Dinner (6.00 PM - 9.00 PM)') {
      values[i][21] = 'DINNER';
    } else if (cellValueV === 'Lunch (4.00 AM - 11.00 AM)') {
      values[i][21] = 'LUNCH';
    } else if (cellValueV === 'Lunch (8.00 AM - 11.00 AM)') {
      values[i][21] = 'LUNCH';
    } else if (cellValueV === 'Lunch (9.00 AM - 1.00 PM)') {
      values[i][21] = 'LUNCH';
    } else if (cellValueV === 'Lunch (10.00 AM - 3.00 PM)') {
      values[i][21] = 'LUNCH';
    }

    // Check if the SKU in column J matches the specified SKUs
    var skusToMatchWTD = [
      'STASH-TD-TS01-W05-ONCA-VEG08',
      'STASH-TD-TS02-W05-ONCA-VEG08',
      'STASH-TD-TS03-W05-ONCA-VEG12',
      'STASH-TD-TS04-W05-ONCA-VEG12',
      'STASH-TD-TS05-W05-ONCA-VEG12',
      'STASH-TD-TS06-W05-ONCA-NVG12',
      'STASH-TD-TS07-W05-ONCA-NVG12',
      'STASH-TD-TS08-W05-ONCA-NVG12',
      'STASH-TD-TS10-W05-ONCA-VEG08',
      'STASH-TD-TS11-W05-ONCA-VEG08',
      'STASH-TD-TS12-W05-ONCA-VEG08',
      'STASH-TD-TS13-W05-ONCA-VEG08',
      'STASH-TD-TS14-W05-ONCA-VEG12',
      'STASH-TD-TS15-W05-ONCA-VEG12',
      'STASH-TD-TS16-W05-ONCA-VEG12'

    ];
    
    var skusToMatchGTD = [
      'STASH-TD-TS09-W05-ONCA-GUJ01'
    ];

    // Add '-WTD' to the Order ID in column A if the SKU matches the specified SKUs for WTD
    if (skusToMatchWTD.indexOf(cellValueJ) !== -1) {
      values[i][0] += '-WTD';
    }

    // Add '-GTD' to the Order ID in column A if the SKU matches the specified SKU for GTD
    if (skusToMatchGTD.indexOf(cellValueJ) !== -1) {
      values[i][0] += '-GTD';
    }
  }

  // Update the values in the sheet
  dataRange.setValues(values);
}

Turn on screen reader support
To enable screen reader support, press ⌘+Option+Z To learn about keyboard shortcuts, press ⌘slash




Get professional email like "@your-company.com"
Plus 2 TB of storage per user, longer video calls, and more with Google Workspace.
SCRIPTS DETAILED
100%
F8

/** ---------- Date helpers (DST-safe, Mon–Fri only) ---------- **/
function addBusinessDays_(startDate, nDays) {
  const d = new Date(startDate);
  d.setHours(12, 0, 0, 0); // normalize to midday to avoid DST jumps
  let added = 0;
  while (added < nDays) {
    d.setDate(d.getDate() + 1);
    const dow = d.getDay(); // 0 Sun … 6 Sat
    if (dow !== 0 && dow !== 6) added++;
  }
  return d;
}

function nextBusinessDay_(dateObj) {
  const d = new Date(dateObj);
  d.setHours(12, 0, 0, 0);
  while (d.getDay() === 0 || d.getDay() === 6) {
    d.setDate(d.getDate() + 1);
  }
  return d;
}

/** ---------- Combined TS01–TS16 updater ---------- **/
function updateOrders_TS01_to_TS16() {
  const ss = SpreadsheetApp.getActiveSpreadsheet();
  const sh = ss.getSheetByName('1. EXPORT ORDERS');
  const data = sh.getDataRange().getValues();
  if (!data.length) return;

  const HEADER = data[0];
  const out = [HEADER];

  // Column indices (0-based)
  const IDX_SKU  = 9;   // J
  const IDX_DATE = 25;  // Z

  // Canada timezone (Toronto)
  const tz = 'America/Toronto';

  // Map: TARGET_SKU -> replacement SKUs (5 rows)
  const MAP = {
    // TS01–TS05
    'STASH-TD-TS01-W05-ONCA-VEG08': [
      'TPROS-TD-MT91-T01-ONCA-TPROS',
      'FIERY-TD-MT01-T01-ONCA-FGBVG',
      'LALKT-TD-MT31-T01-ONCA-SWAGT',
      'ANGTH-TD-MT40-T01-ONCA-ANGVG',
      'KRISK-TD-MT01-T01-ONCA-KRIVG'
    ],
    'STASH-TD-TS02-W05-ONCA-VEG08': [
      'TPROS-TD-MT92-T01-ONCA-TPROS',
      'FIERY-TD-MT02-T01-ONCA-FGBVG',
      'LALKT-TD-MT30-T01-ONCA-SWAGT',
      'ANGTH-TD-MT41-T01-ONCA-ANGVG',
      'KRISK-TD-MT02-T01-ONCA-KRIVG'
    ],
    'STASH-TD-TS03-W05-ONCA-VEG12': [
      'TPROS-TD-MT93-T01-ONCA-TPROS',
      'FIERY-TD-MT06-T01-ONCA-FGPVG',
      'LALKT-TD-MT01-T01-ONCA-LEELA',
      'ANGTH-TD-MT40-T01-ONCA-ANGVG',
      'KRISK-TD-MT07-T01-ONCA-KRIVG'
    ],
    'STASH-TD-TS04-W05-ONCA-VEG12': [
      'TPROS-TD-MT94-T01-ONCA-TPROS',
      'FIERY-TD-MT09-T01-ONCA-FGPVG',
      'LALKT-TD-MT03-T01-ONCA-LEELA',
      'ANGTH-TD-MT47-T01-ONCA-ANGVG',
      'KRISK-TD-MT92-T01-ONCA-KRIVG'
    ],
    'STASH-TD-TS05-W05-ONCA-VEG12': [
      'TPROS-TD-MT95-T01-ONCA-TPROS',
      'FIERY-TD-MT12-T01-ONCA-FGPVG',
      'LALKT-TD-MT04-T01-ONCA-LEELA',
      'ANGTH-TD-MT50-T01-ONCA-ANGVG',
      'KRISK-TD-MT93-T01-ONCA-KRIVG'
    ],

    // TS06–TS08 (NVG12)
    'STASH-TD-TS06-W05-ONCA-NVG12': [
      'LALKT-TD-MT20-T01-ONCA-LALIT',
      'FIERY-TD-MT19-T01-ONCA-FGPNV',
      'WAKHR-TD-MT19-T01-ONCA-KTDNV',
      'ANGTH-TD-MT58-T01-ONCA-ANGNV',
      'FEAST-TD-MT34-T01-ONCA-SPFNV'
    ],
    'STASH-TD-TS07-W05-ONCA-NVG12': [
      'LALKT-TD-MT24-T01-ONCA-LALIT',
      'FIERY-TD-MT20-T01-ONCA-FGPNV',
      'WAKHR-TD-MT20-T01-ONCA-KTDNV',
      'ANGTH-TD-MT60-T01-ONCA-ANGNV',
      'FEAST-TD-MT21-T01-ONCA-SPFNV'
    ],
    'STASH-TD-TS08-W05-ONCA-NVG12': [
      'LALKT-TD-MT83-T01-ONCA-LALIT',
      'FIERY-TD-MT23-T01-ONCA-FGPNV',
      'WAKHR-TD-MT23-T01-ONCA-KTDNV',
      'ANGTH-TD-MT61-T01-ONCA-ANGNV',
      'FEAST-TD-MT22-T01-ONCA-SPFNV'
    ],

    // TS09 (GUJ01)
    'STASH-TD-TS09-W05-ONCA-GUJ01': [
      'SRIJI-TD-MT03-T01-ONCA-SRIJI',
      'SPBAR-TD-MT27-T01-ONCA-SBPGJ',
      'TSWAD-TD-MT04-T01-ONCA-FRESH',
      'RADHA-TD-MT08-T01-ONCA-RRBVG',
      'MUMMA-TD-MT04-T01-ONCA-MMGUJ'
    ],

    // TS10 (VEG08)
    'STASH-TD-TS10-W05-ONCA-VEG08': [
      'TPROS-TD-MT96-T01-ONCA-TPROS',
      'FIERY-TD-MT05-T01-ONCA-FGBVG',
      'LALKT-TD-MT35-T01-ONCA-SWAGT',
      'ANGTH-TD-MT44-T01-ONCA-ANGVG',
      'KRISK-TD-MT91-T01-ONCA-KRIVG'
    ],

    // TS11–TS13 (VEG08)
    'STASH-TD-TS11-W05-ONCA-VEG08': [
      'LALKT-TD-MT31-T01-ONCA-SWAGT',
      'FIERY-TD-MT01-T01-ONCA-FGBVG',
      'WAKHR-TD-MT01-T01-ONCA-WCBVG',
      'INFLV-TD-MT94-T01-ONCA-INFVG',
      'FEAST-TD-MT01-T01-ONCA-SPFVG'
    ],
    'STASH-TD-TS12-W05-ONCA-VEG08': [
      'LALKT-TD-MT30-T01-ONCA-SWAGT',
      'FIERY-TD-MT02-T01-ONCA-FGBVG',
      'WAKHR-TD-MT02-T01-ONCA-WCBVG',
      'INFLV-TD-MT95-T01-ONCA-INFVG',
      'FEAST-TD-MT02-T01-ONCA-SPFVG'
    ],
    'STASH-TD-TS13-W05-ONCA-VEG08': [
      'LALKT-TD-MT35-T01-ONCA-SWAGT',
      'FIERY-TD-MT05-T01-ONCA-FGBVG',
      'WAKHR-TD-MT03-T01-ONCA-WCBVG',
      'INFLV-TD-MT93-T01-ONCA-INFVG',
      'FEAST-TD-MT05-T01-ONCA-SPFVG'
    ],

    // TS14–TS16 (VEG12)
    'STASH-TD-TS14-W05-ONCA-VEG12': [
      'LALKT-TD-MT01-T01-ONCA-LEELA',
      'FIERY-TD-MT06-T01-ONCA-FGPVG',
      'WAKHR-TD-MT08-T01-ONCA-WCPVG',
      'INFLV-TD-MT96-T01-ONCA-INFVG',
      'FEAST-TD-MT08-T01-ONCA-SPFVG'
    ],
    'STASH-TD-TS15-W05-ONCA-VEG12': [
      'LALKT-TD-MT03-T01-ONCA-LEELA',
      'FIERY-TD-MT09-T01-ONCA-FGPVG',
      'WAKHR-TD-MT04-T01-ONCA-KTDVG',
      'INFLV-TD-MT91-T01-ONCA-INFVG',
      'FEAST-TD-MT11-T01-ONCA-SPFVG'
    ],
    'STASH-TD-TS16-W05-ONCA-VEG12': [
      'LALKT-TD-MT04-T01-ONCA-LEELA',
      'FIERY-TD-MT12-T01-ONCA-FGPVG',
      'WAKHR-TD-MT11-T01-ONCA-WCPVG',
      'INFLV-TD-MT92-T01-ONCA-INFVG',
      'FEAST-TD-MT14-T01-ONCA-SPFVG'
    ]
  };

  for (let i = 1; i < data.length; i++) {
    const row = data[i];
    const sku = row[IDX_SKU];

    // Not a parent SKU we expand → passthrough
    if (!MAP[sku]) {
      out.push(row);
      continue;
    }

    // Base date in Z can be Date or parseable string
    let base = row[IDX_DATE] instanceof Date ? new Date(row[IDX_DATE]) : new Date(row[IDX_DATE]);
    if (isNaN(base)) {
      out.push(row);
      continue;
    }

    // Ensure start on a business day
    const startBiz = nextBusinessDay_(base);

    // Expand into 5 child rows on consecutive business days
    const replacements = MAP[sku];
    for (let k = 0; k < replacements.length; k++) {
      const clone = row.slice();
      clone[IDX_SKU] = replacements[k];

      const d = (k === 0) ? new Date(startBiz) : addBusinessDays_(startBiz, k);
      clone[IDX_DATE] = Utilities.formatDate(d, tz, 'yyyy-MM-dd'); // date-only

      out.push(clone);
    }
  }

  // Replace data (preserves formatting)
  sh.clearContents();
  sh.getRange(1, 1, out.length, out[0].length).setValues(out);
}

 
 
 	
/** ---------- Date helpers (DST-safe, Mon–Fri only) ---------- **/
function addBusinessDays_(startDate, nDays) {
  const d = new Date(startDate);
  d.setHours(12, 0, 0, 0); // normalize to midday to avoid DST jumps
  let added = 0;
  while (added < nDays) {
    d.setDate(d.getDate() + 1);
    const dow = d.getDay(); // 0 Sun … 6 Sat
    if (dow !== 0 && dow !== 6) added++;
  }
  return d;
}

function nextBusinessDay_(dateObj) {
  const d = new Date(dateObj);
  d.setHours(12, 0, 0, 0);
  while (d.getDay() === 0 || d.getDay() === 6) {
    d.setDate(d.getDate() + 1);
  }
  return d;
}

/** ---------- Combined TS01–TS16 updater ---------- **/
function updateOrders_TS01_to_TS16() {
  const ss = SpreadsheetApp.getActiveSpreadsheet();
  const sh = ss.getSheetByName('1. EXPORT ORDERS');
  const data = sh.getDataRange().getValues();
  if (!data.length) return;

  const HEADER = data[0];
  const out = [HEADER];

  // Column indices (0-based)
  const IDX_SKU  = 9;   // J
  const IDX_DATE = 25;  // Z

  // Canada timezone (Toronto)
  const tz = 'America/Toronto';

  // Map: TARGET_SKU -> replacement SKUs (5 rows)
  const MAP = {
    // TS01–TS05
    'STASH-TD-TS01-W05-ONCA-VEG08': [
      'TPROS-TD-MT91-T01-ONCA-TPROS',
      'FIERY-TD-MT01-T01-ONCA-FGBVG',
      'LALKT-TD-MT31-T01-ONCA-SWAGT',
      'ANGTH-TD-MT40-T01-ONCA-ANGVG',
      'KRISK-TD-MT01-T01-ONCA-KRIVG'
    ],
    'STASH-TD-TS02-W05-ONCA-VEG08': [
      'TPROS-TD-MT92-T01-ONCA-TPROS',
      'FIERY-TD-MT02-T01-ONCA-FGBVG',
      'LALKT-TD-MT30-T01-ONCA-SWAGT',
      'ANGTH-TD-MT41-T01-ONCA-ANGVG',
      'KRISK-TD-MT02-T01-ONCA-KRIVG'
    ],
    'STASH-TD-TS03-W05-ONCA-VEG12': [
      'TPROS-TD-MT93-T01-ONCA-TPROS',
      'FIERY-TD-MT06-T01-ONCA-FGPVG',
      'LALKT-TD-MT01-T01-ONCA-LEELA',
      'ANGTH-TD-MT40-T01-ONCA-ANGVG',
      'KRISK-TD-MT07-T01-ONCA-KRIVG'
    ],
    'STASH-TD-TS04-W05-ONCA-VEG12': [
      'TPROS-TD-MT94-T01-ONCA-TPROS',
      'FIERY-TD-MT09-T01-ONCA-FGPVG',
      'LALKT-TD-MT03-T01-ONCA-LEELA',
      'ANGTH-TD-MT47-T01-ONCA-ANGVG',
      'KRISK-TD-MT92-T01-ONCA-KRIVG'
    ],
    'STASH-TD-TS05-W05-ONCA-VEG12': [
      'TPROS-TD-MT95-T01-ONCA-TPROS',
      'FIERY-TD-MT12-T01-ONCA-FGPVG',
      'LALKT-TD-MT04-T01-ONCA-LEELA',
      'ANGTH-TD-MT50-T01-ONCA-ANGVG',
      'KRISK-TD-MT93-T01-ONCA-KRIVG'
    ],

    // TS06–TS08 (NVG12)
    'STASH-TD-TS06-W05-ONCA-NVG12': [
      'LALKT-TD-MT20-T01-ONCA-LALIT',
      'FIERY-TD-MT19-T01-ONCA-FGPNV',
      'WAKHR-TD-MT19-T01-ONCA-KTDNV',
      'ANGTH-TD-MT58-T01-ONCA-ANGNV',
      'FEAST-TD-MT34-T01-ONCA-SPFNV'
    ],
    'STASH-TD-TS07-W05-ONCA-NVG12': [
      'LALKT-TD-MT24-T01-ONCA-LALIT',
      'FIERY-TD-MT20-T01-ONCA-FGPNV',
      'WAKHR-TD-MT20-T01-ONCA-KTDNV',
      'ANGTH-TD-MT60-T01-ONCA-ANGNV',
      'FEAST-TD-MT21-T01-ONCA-SPFNV'
    ],
    'STASH-TD-TS08-W05-ONCA-NVG12': [
      'LALKT-TD-MT83-T01-ONCA-LALIT',
      'FIERY-TD-MT23-T01-ONCA-FGPNV',
      'WAKHR-TD-MT23-T01-ONCA-KTDNV',
      'ANGTH-TD-MT61-T01-ONCA-ANGNV',
      'FEAST-TD-MT22-T01-ONCA-SPFNV'
    ],

    // TS09 (GUJ01)
    'STASH-TD-TS09-W05-ONCA-GUJ01': [
      'SRIJI-TD-MT03-T01-ONCA-SRIJI',
      'SPBAR-TD-MT27-T01-ONCA-SBPGJ',
      'TSWAD-TD-MT04-T01-ONCA-FRESH',
      'RADHA-TD-MT08-T01-ONCA-RRBVG',
      'MUMMA-TD-MT04-T01-ONCA-MMGUJ'
    ],

    // TS10 (VEG08)
    'STASH-TD-TS10-W05-ONCA-VEG08': [
      'TPROS-TD-MT96-T01-ONCA-TPROS',
      'FIERY-TD-MT05-T01-ONCA-FGBVG',
      'LALKT-TD-MT35-T01-ONCA-SWAGT',
      'ANGTH-TD-MT44-T01-ONCA-ANGVG',
      'KRISK-TD-MT91-T01-ONCA-KRIVG'
    ],

    // TS11–TS13 (VEG08)
    'STASH-TD-TS11-W05-ONCA-VEG08': [
      'LALKT-TD-MT31-T01-ONCA-SWAGT',
      'FIERY-TD-MT01-T01-ONCA-FGBVG',
      'WAKHR-TD-MT01-T01-ONCA-WCBVG',
      'INFLV-TD-MT94-T01-ONCA-INFVG',
      'FEAST-TD-MT01-T01-ONCA-SPFVG'
    ],
    'STASH-TD-TS12-W05-ONCA-VEG08': [
      'LALKT-TD-MT30-T01-ONCA-SWAGT',
      'FIERY-TD-MT02-T01-ONCA-FGBVG',
      'WAKHR-TD-MT02-T01-ONCA-WCBVG',
      'INFLV-TD-MT95-T01-ONCA-INFVG',
      'FEAST-TD-MT02-T01-ONCA-SPFVG'
    ],
    'STASH-TD-TS13-W05-ONCA-VEG08': [
      'LALKT-TD-MT35-T01-ONCA-SWAGT',
      'FIERY-TD-MT05-T01-ONCA-FGBVG',
      'WAKHR-TD-MT03-T01-ONCA-WCBVG',
      'INFLV-TD-MT93-T01-ONCA-INFVG',
      'FEAST-TD-MT05-T01-ONCA-SPFVG'
    ],

    // TS14–TS16 (VEG12)
    'STASH-TD-TS14-W05-ONCA-VEG12': [
      'LALKT-TD-MT01-T01-ONCA-LEELA',
      'FIERY-TD-MT06-T01-ONCA-FGPVG',
      'WAKHR-TD-MT08-T01-ONCA-WCPVG',
      'INFLV-TD-MT96-T01-ONCA-INFVG',
      'FEAST-TD-MT08-T01-ONCA-SPFVG'
    ],
    'STASH-TD-TS15-W05-ONCA-VEG12': [
      'LALKT-TD-MT03-T01-ONCA-LEELA',
      'FIERY-TD-MT09-T01-ONCA-FGPVG',
      'WAKHR-TD-MT04-T01-ONCA-KTDVG',
      'INFLV-TD-MT91-T01-ONCA-INFVG',
      'FEAST-TD-MT11-T01-ONCA-SPFVG'
    ],
    'STASH-TD-TS16-W05-ONCA-VEG12': [
      'LALKT-TD-MT04-T01-ONCA-LEELA',
      'FIERY-TD-MT12-T01-ONCA-FGPVG',
      'WAKHR-TD-MT11-T01-ONCA-WCPVG',
      'INFLV-TD-MT92-T01-ONCA-INFVG',
      'FEAST-TD-MT14-T01-ONCA-SPFVG'
    ]
  };

  for (let i = 1; i < data.length; i++) {
    const row = data[i];
    const sku = row[IDX_SKU];

    // Not a parent SKU we expand → passthrough
    if (!MAP[sku]) {
      out.push(row);
      continue;
    }

    // Base date in Z can be Date or parseable string
    let base = row[IDX_DATE] instanceof Date ? new Date(row[IDX_DATE]) : new Date(row[IDX_DATE]);
    if (isNaN(base)) {
      out.push(row);
      continue;
    }

    // Ensure start on a business day
    const startBiz = nextBusinessDay_(base);

    // Expand into 5 child rows on consecutive business days
    const replacements = MAP[sku];
    for (let k = 0; k < replacements.length; k++) {
      const clone = row.slice();
      clone[IDX_SKU] = replacements[k];

      const d = (k === 0) ? new Date(startBiz) : addBusinessDays_(startBiz, k);
      clone[IDX_DATE] = Utilities.formatDate(d, tz, 'yyyy-MM-dd'); // date-only

      out.push(clone);
    }
  }

  // Replace data (preserves formatting)
  sh.clearContents();
  sh.getRange(1, 1, out.length, out[0].length).setValues(out);
}

Turn on screen reader support
To enable screen reader support, press ⌘+Option+Z To learn about keyboard shortcuts, press ⌘slash




Get professional email like "@your-company.com"
Plus 2 TB of storage per user, longer video calls, and more with Google Workspace.
SCRIPTS DETAILED
100%
F9

function swapDates() {
  // Get the sheet '1. EXPORT ORDERS'
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName('1. EXPORT ORDERS');
  
  // Get the range of column J and Y (assuming there's data in the first 1000 rows)
  var rangeJ = sheet.getRange('J1:J1000');
  var rangeZ = sheet.getRange('Z1:Z1000');
  
  // Get the values of the range
  var valuesJ = rangeJ.getValues();
  var valuesY = rangeZ.getValues();
  
  // Initialize indices for 'SRIJI' and 'SPBAR' series
  var sriIndex = -1;
  var spbarIndex = -1;
  
  // Iterate through column J to find the indices of 'SRIJI' and 'SPBAR' series
  for (var i = 0; i < valuesJ.length; i++) {
    if (valuesJ[i][0] == 'SRIJI-TD-MT03-T01-ONCA-SRIJI') {
      sriIndex = i;
    } else if (valuesJ[i][0] == 'SPBAR-TD-MT13-T01-ONCA-SBPGJ') {
      spbarIndex = i;
    }
    
    // Break if both series have been found
    if (sriIndex !== -1 && spbarIndex !== -1) {
      break;
    }
  }
  
  // If both 'SRIJI' and 'SPBAR' series are found
  if (sriIndex !== -1 && spbarIndex !== -1) {
    // Get the date for 'SRIJI'
    var sriDate = valuesY[sriIndex][0];
    
    // Check if 'SRIJI' date is a Tuesday
    var date = new Date(sriDate);
    if (date.getDay() == 2) { // 2 represents Tuesday
      // Get 'SPBAR' date
      var spbarDate = valuesY[spbarIndex][0];
      
      // Swap dates
      rangeZ.getCell(sriIndex + 1, 1).setValue(spbarDate);
      rangeZ.getCell(spbarIndex + 1, 1).setValue(sriDate);
    }
  }
}

 
 
 	
function swapDates() {
  // Get the sheet '1. EXPORT ORDERS'
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName('1. EXPORT ORDERS');
  
  // Get the range of column J and Y (assuming there's data in the first 1000 rows)
  var rangeJ = sheet.getRange('J1:J1000');
  var rangeZ = sheet.getRange('Z1:Z1000');
  
  // Get the values of the range
  var valuesJ = rangeJ.getValues();
  var valuesY = rangeZ.getValues();
  
  // Initialize indices for 'SRIJI' and 'SPBAR' series
  var sriIndex = -1;
  var spbarIndex = -1;
  
  // Iterate through column J to find the indices of 'SRIJI' and 'SPBAR' series
  for (var i = 0; i < valuesJ.length; i++) {
    if (valuesJ[i][0] == 'SRIJI-TD-MT03-T01-ONCA-SRIJI') {
      sriIndex = i;
    } else if (valuesJ[i][0] == 'SPBAR-TD-MT13-T01-ONCA-SBPGJ') {
      spbarIndex = i;
    }
    
    // Break if both series have been found
    if (sriIndex !== -1 && spbarIndex !== -1) {
      break;
    }
  }
  
  // If both 'SRIJI' and 'SPBAR' series are found
  if (sriIndex !== -1 && spbarIndex !== -1) {
    // Get the date for 'SRIJI'
    var sriDate = valuesY[sriIndex][0];
    
    // Check if 'SRIJI' date is a Tuesday
    var date = new Date(sriDate);
    if (date.getDay() == 2) { // 2 represents Tuesday
      // Get 'SPBAR' date
      var spbarDate = valuesY[spbarIndex][0];
      
      // Swap dates
      rangeZ.getCell(sriIndex + 1, 1).setValue(spbarDate);
      rangeZ.getCell(spbarIndex + 1, 1).setValue(sriDate);
    }
  }
}

Turn on screen reader support
To enable screen reader support, press ⌘+Option+Z To learn about keyboard shortcuts, press ⌘slash






Get professional email like "@your-company.com"
Plus 2 TB of storage per user, longer video calls, and more with Google Workspace.
SCRIPTS DETAILED
100%
D10

function updateColumnQ() {
  var sheetName = '1. EXPORT ORDERS';
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName(sheetName);
  
  // Get data range
  var range = sheet.getDataRange();
  var values = range.getValues();
  
  // Iterate through each row
  for (var i = 1; i < values.length; i++) {
    var colTValue = values[i][19]; // Column T is 20th column (index 19 in zero-based indexing)
    var colUValue = values[i][20]; // Column U is 21st column (index 20 in zero-based indexing)
    
    // Check if column T contains anything other than 0 or empty string
    if (colTValue !== 0 && colTValue !== "") {
      var colCValue = values[i][2]; // Column C is 3rd column (index 2 in zero-based indexing)
      var names = colCValue.split(" ");
      var firstName = names[0];
      var lastName = names.length > 1 ? names[1].substring(0, 3) : ""; // Up to first 5 letters of last name
      
      // Update column Q with the first name and truncated last name
      sheet.getRange(i + 1, 17).setValue(firstName + " " + lastName); // Column Q is 17th column (index 16 in zero-based indexing)
    }
    
    // Check if column U contains 0 and change it to 'No'
    if (colUValue === "") {
      sheet.getRange(i + 1, 21).setValue('No'); // Column U is 21st column (index 20 in zero-based indexing)
    }
  }
}

 
 
 	
function updateColumnQ() {
  var sheetName = '1. EXPORT ORDERS';
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName(sheetName);
  
  // Get data range
  var range = sheet.getDataRange();
  var values = range.getValues();
  
  // Iterate through each row
  for (var i = 1; i < values.length; i++) {
    var colTValue = values[i][19]; // Column T is 20th column (index 19 in zero-based indexing)
    var colUValue = values[i][20]; // Column U is 21st column (index 20 in zero-based indexing)
    
    // Check if column T contains anything other than 0 or empty string
    if (colTValue !== 0 && colTValue !== "") {
      var colCValue = values[i][2]; // Column C is 3rd column (index 2 in zero-based indexing)
      var names = colCValue.split(" ");
      var firstName = names[0];
      var lastName = names.length > 1 ? names[1].substring(0, 3) : ""; // Up to first 5 letters of last name
      
      // Update column Q with the first name and truncated last name
      sheet.getRange(i + 1, 17).setValue(firstName + " " + lastName); // Column Q is 17th column (index 16 in zero-based indexing)
    }
    
    // Check if column U contains 0 and change it to 'No'
    if (colUValue === "") {
      sheet.getRange(i + 1, 21).setValue('No'); // Column U is 21st column (index 20 in zero-based indexing)
    }
  }
}

Turn on screen reader support
To enable screen reader support, press ⌘+Option+Z To learn about keyboard shortcuts, press ⌘slash




Get professional email like "@your-company.com"
Plus 2 TB of storage per user, longer video calls, and more with Google Workspace.
SCRIPTS DETAILED
100%
D11

function copyAndPasteValues() {
  var sourceSheetName = '1. EXPORT ORDERS';
  var destinationSheetName = '2. MASTER (S)';

  var sourceSheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName(sourceSheetName);
  var destinationSheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName(destinationSheetName);

  var sourceData = sourceSheet.getRange("A2:Z" + sourceSheet.getLastRow()).getValues();

  var lastRow = destinationSheet.getLastRow();
  var pasteRange = destinationSheet.getRange(lastRow + 1, 1, sourceData.length, sourceData[0].length);
  pasteRange.setValues(sourceData);

  var formulaColumns = ['K', 'L', 'M', 'N', 'O', 'P', 'R', 'Y', 'AA', 'AB', 'AZ', 'BA', 'BB'];
  var lastSourceRow = lastRow + 1;
  var lastDestinationRow = lastRow + sourceData.length;

  formulaColumns.forEach(function(column) {
    var lastFormulaRow = destinationSheet.getRange(lastRow, destinationSheet.getRange(column + lastRow).getColumn()).getFormulaR1C1();
    var formulas = destinationSheet.getRange(lastSourceRow, destinationSheet.getRange(column + lastSourceRow).getColumn(), lastDestinationRow - lastSourceRow + 1, 1).getFormulas();
    formulas.forEach(function(formulaRow, rowIndex) {
      formulas[rowIndex] = formulaRow.map(function(formulaCell, colIndex) {
        return colIndex === 0 ? lastFormulaRow : formulaCell;
      });
    });
    destinationSheet.getRange(lastSourceRow, destinationSheet.getRange(column + lastSourceRow).getColumn(), lastDestinationRow - lastSourceRow + 1, 1).setFormulas(formulas);
  });

  // Update columns to '0'
  var zeroColumns = ['Q', 'AC', 'AD', 'AE', 'AF', 'AG', 'AH', 'AI', 'AJ', 'AK', 'AL', 'AM', 'AN', 'AO', 'AP', 'AQ', 'AR', 'AS', 'AT', 'AU','AV'];
  zeroColumns.forEach(function(column) {
    var range = destinationSheet.getRange(lastSourceRow, destinationSheet.getRange(column + lastSourceRow).getColumn(), lastDestinationRow - lastSourceRow + 1);
    range.setValue('0');
  });

  // Update columns to '-'
  var hyphenColumns = ['AW', 'AX', 'AY'];
  hyphenColumns.forEach(function(column) {
    var range = destinationSheet.getRange(lastSourceRow, destinationSheet.getRange(column + lastSourceRow).getColumn(), lastDestinationRow - lastSourceRow + 1);
    range.setValue('-');
  });

  // Copy values from column 'Q' in source sheet to column 'Q' in destination sheet
  var xColumnValues = sourceSheet.getRange("Q2:Q" + sourceSheet.getLastRow()).getValues();
  var   qColumnValues = [];
  xColumnValues.forEach(function(row) {
    if (row[0] !== '') {
      qColumnValues.push([row[0]]);
    } else {
      qColumnValues.push(['0']);
    }
  });
  var qColumnRange = destinationSheet.getRange(lastSourceRow, destinationSheet.getRange('Q' + lastSourceRow).getColumn(), lastDestinationRow - lastSourceRow + 1);
  qColumnRange.setValues(qColumnValues);

  // Drag columns without formulas
  var columnsWithoutFormulas = ['X'];
  columnsWithoutFormulas.forEach(function(column) {
    var sourceRange = destinationSheet.getRange(lastRow, destinationSheet.getRange(column + lastRow).getColumn(), sourceData.length, 1);
    var destinationRange = destinationSheet.getRange(lastSourceRow, destinationSheet.getRange(column + lastSourceRow).getColumn(), lastDestinationRow - lastRow + 1);
    sourceRange.copyTo(destinationRange);
  });

  var values = destinationSheet.getRange(lastSourceRow, destinationSheet.getRange('N' + lastSourceRow).getColumn(), lastDestinationRow - lastSourceRow + 1, 1).getValues();

  values.forEach(function(row, index) {
    var value = row[0];
    var output;

    switch (value) {
      case 'Trial':
        output = 1;
        break;
      case 'Weekly':
        output = 5;
        break;
      case 'Monthly':
        output = 20;
        break;
      case 'Weekly (4 Days)':
        output = 4;
        break;
      case 'Monthly (16 Days)':
        output = 16;
        break;
      case 'Weekly (3 Days)':
        output = 3;
        break;
      case 'Monthly (12 Days)':
        output = 12;
        break;
      default:
        output = '';
        break;
    }

    values[index][0] = output;
  });

  var outputRange = destinationSheet.getRange(lastSourceRow, destinationSheet.getRange('X' + lastSourceRow).getColumn(), lastDestinationRow - lastSourceRow + 1, 1);
  outputRange.setValues(values);

  // Clear formulas beyond the last row of the pasted data
  var lastColumn = destinationSheet.getLastColumn();
  var clearRange = destinationSheet.getRange(lastDestinationRow + 1, 1, destinationSheet.getLastRow() - lastDestinationRow + 1, lastColumn);
  clearRange.clearContent();
}

 
 
 	
function copyAndPasteValues() {
  var sourceSheetName = '1. EXPORT ORDERS';
  var destinationSheetName = '2. MASTER (S)';

  var sourceSheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName(sourceSheetName);
  var destinationSheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName(destinationSheetName);

  var sourceData = sourceSheet.getRange("A2:Z" + sourceSheet.getLastRow()).getValues();

  var lastRow = destinationSheet.getLastRow();
  var pasteRange = destinationSheet.getRange(lastRow + 1, 1, sourceData.length, sourceData[0].length);
  pasteRange.setValues(sourceData);

  var formulaColumns = ['K', 'L', 'M', 'N', 'O', 'P', 'R', 'Y', 'AA', 'AB', 'AZ', 'BA', 'BB'];
  var lastSourceRow = lastRow + 1;
  var lastDestinationRow = lastRow + sourceData.length;

  formulaColumns.forEach(function(column) {
    var lastFormulaRow = destinationSheet.getRange(lastRow, destinationSheet.getRange(column + lastRow).getColumn()).getFormulaR1C1();
    var formulas = destinationSheet.getRange(lastSourceRow, destinationSheet.getRange(column + lastSourceRow).getColumn(), lastDestinationRow - lastSourceRow + 1, 1).getFormulas();
    formulas.forEach(function(formulaRow, rowIndex) {
      formulas[rowIndex] = formulaRow.map(function(formulaCell, colIndex) {
        return colIndex === 0 ? lastFormulaRow : formulaCell;
      });
    });
    destinationSheet.getRange(lastSourceRow, destinationSheet.getRange(column + lastSourceRow).getColumn(), lastDestinationRow - lastSourceRow + 1, 1).setFormulas(formulas);
  });

  // Update columns to '0'
  var zeroColumns = ['Q', 'AC', 'AD', 'AE', 'AF', 'AG', 'AH', 'AI', 'AJ', 'AK', 'AL', 'AM', 'AN', 'AO', 'AP', 'AQ', 'AR', 'AS', 'AT', 'AU','AV'];
  zeroColumns.forEach(function(column) {
    var range = destinationSheet.getRange(lastSourceRow, destinationSheet.getRange(column + lastSourceRow).getColumn(), lastDestinationRow - lastSourceRow + 1);
    range.setValue('0');
  });

  // Update columns to '-'
  var hyphenColumns = ['AW', 'AX', 'AY'];
  hyphenColumns.forEach(function(column) {
    var range = destinationSheet.getRange(lastSourceRow, destinationSheet.getRange(column + lastSourceRow).getColumn(), lastDestinationRow - lastSourceRow + 1);
    range.setValue('-');
  });

  // Copy values from column 'Q' in source sheet to column 'Q' in destination sheet
  var xColumnValues = sourceSheet.getRange("Q2:Q" + sourceSheet.getLastRow()).getValues();
  var   qColumnValues = [];
  xColumnValues.forEach(function(row) {
    if (row[0] !== '') {
      qColumnValues.push([row[0]]);
    } else {
      qColumnValues.push(['0']);
    }
  });
  var qColumnRange = destinationSheet.getRange(lastSourceRow, destinationSheet.getRange('Q' + lastSourceRow).getColumn(), lastDestinationRow - lastSourceRow + 1);
  qColumnRange.setValues(qColumnValues);

  // Drag columns without formulas
  var columnsWithoutFormulas = ['X'];
  columnsWithoutFormulas.forEach(function(column) {
    var sourceRange = destinationSheet.getRange(lastRow, destinationSheet.getRange(column + lastRow).getColumn(), sourceData.length, 1);
    var destinationRange = destinationSheet.getRange(lastSourceRow, destinationSheet.getRange(column + lastSourceRow).getColumn(), lastDestinationRow - lastRow + 1);
    sourceRange.copyTo(destinationRange);
  });

  var values = destinationSheet.getRange(lastSourceRow, destinationSheet.getRange('N' + lastSourceRow).getColumn(), lastDestinationRow - lastSourceRow + 1, 1).getValues();

  values.forEach(function(row, index) {
    var value = row[0];
    var output;

    switch (value) {
      case 'Trial':
        output = 1;
        break;
      case 'Weekly':
        output = 5;
        break;
      case 'Monthly':
        output = 20;
        break;
      case 'Weekly (4 Days)':
        output = 4;
        break;
      case 'Monthly (16 Days)':
        output = 16;
        break;
      case 'Weekly (3 Days)':
        output = 3;
        break;
      case 'Monthly (12 Days)':
        output = 12;
        break;
      default:
        output = '';
        break;
    }

    values[index][0] = output;
  });

  var outputRange = destinationSheet.getRange(lastSourceRow, destinationSheet.getRange('X' + lastSourceRow).getColumn(), lastDestinationRow - lastSourceRow + 1, 1);
  outputRange.setValues(values);

  // Clear formulas beyond the last row of the pasted data
  var lastColumn = destinationSheet.getLastColumn();
  var clearRange = destinationSheet.getRange(lastDestinationRow + 1, 1, destinationSheet.getLastRow() - lastDestinationRow + 1, lastColumn);
  clearRange.clearContent();
}

Turn on screen reader support
To enable screen reader support, press ⌘+Option+Z To learn about keyboard shortcuts, press ⌘slash